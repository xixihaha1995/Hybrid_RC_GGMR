%setup A B C D for state space models
function [A B C D]=M_ssMatrix(ssRC,n,m)
%% reference: J. Braun & N. Chaturvedi (2002)
%         R_e1=ssRC(1);
%         R_e2=ssRC(2);
%         R_e3=ssRC(3);
%         C_e1=ssRC(4);
%         C_e2=ssRC(5);
%         R_c1=ssRC(6);
%         R_c2=ssRC(7);
%         R_c3=ssRC(8);
%         C_c1=ssRC(9);
%         C_c2=ssRC(10);
%         R_f1=ssRC(11);
%         R_f2=ssRC(12);
%         C_f1=ssRC(13);
%         %R_f3=ssRC(13);
%         %C_f1=ssRC(14);
%         %C_f2=ssRC(15);
%         A_11=-(1/(C_e1*R_e1)+1/(C_e1*R_e2));
% 		A_12=1/(C_e1*R_e2);
% 		A_13=0;
%         A_14=0;
%         A_15=0;
%         %A_16=0;
% 		A_21=1/(C_e2*R_e2);
%         A_22=-(1/(C_e2*R_e2)+1/(C_e2*R_e3));
% 		A_23=0;
%         A_24=0;
%         A_25=0;
% 		%A_26=0;
% 		A_31=0;
%         A_32=0;
%         A_33=-(1/(C_c1*R_c1)+1/(C_c1*R_c2));
%         A_34=1/(C_c1*R_c2);
%         A_35=0;
%         %A_36=0;       
%         A_41=0;
%         A_42=0;
%         A_43=1/(C_c2*R_c2);
%         A_44=-(1/(C_c2*R_c2)+1/(C_c2*R_c3));
%         A_45=0;
%         %A_46=0;
%         A_51=0;
%         A_52=0;
%         A_53=0;
%         A_54=0;
%         A_55=-(1/(C_f1*R_f1)+1/(C_f1*R_f2));
%         %A_56=1/(C_f1*R_f2);
%         %A_61=0;
%         %A_62=0;
%         %A_63=0;
%         %A_64=0;
%         %A_65=1/(C_f2*R_f2);
%         %A_66=-(1/(C_f2*R_f2)+1/(C_f2*R_f3));
% 
%         B_11=0;
% 		B_12=1/(C_e1*R_e1);
% 		B_13=0;
% 		B_14=1/C_e1;
%         B_15=0;
% 		B_16=0;
% 		B_21=1/(C_e2*R_e3);
%         B_22=0;
%         B_23=0;
%         B_24=0;
%         B_25=0;
%         B_26=0;
% 		B_31=0;
%         B_32=1/(C_c1*R_c1);
%         B_33=0;
%         B_34=0;
%         B_35=1/C_c1;
%         B_36=0;
%         B_41=1/(C_c2*R_c3);
%         B_42=0;
%         B_43=0;
%         B_44=0;
%         B_45=0;
%         B_46=0;
%         B_51=1/(C_f1*R_f2);
%         B_52=0;
%         B_53=1/(C_f1*R_f1);
%         B_54=0;
%         B_55=0;
%         B_56=0;
%         %B_61=1/(C_f2*R_f3);
% 
% 
% 		
% 		C_11=0;
% 		C_12=1/R_e3;
% 		C_13=0;
% 		C_14=1/R_c3;
% 		C_15=1/R_f2;
% 		%C_16=1/R_f2;
% 		
% 		D_11=-(1/R_e3+1/R_c3+1/R_f2);
% 		D_12=0;
% 		D_13=0;
% 		D_14=0;
% 		D_15=0;
% 		D_16=1;		
% 
% 
%         %A=[A_11 A_12 A_13 A_14 A_15 A_16; A_21 A_22 A_23 A_24 A_25 A_26;...
%         %    A_31 A_32 A_33 A_34 A_35 A_36; A_41 A_42 A_43 A_44 A_45 A_46;...
%         %    A_51 A_52 A_53 A_54 A_55 A_56; A_61 A_62 A_63 A_64 A_65 A_66];
%         A=[A_11 A_12 A_13 A_14 A_15; A_21 A_22 A_23 A_24 A_25;...
%            A_31 A_32 A_33 A_34 A_35; A_41 A_42 A_43 A_44 A_45;...
%            A_51 A_52 A_53 A_54 A_55];
% 
%         B=[B_11 B_12 B_13 B_14 B_15 B_16; B_21 B_22 B_23 B_24 B_25 B_26;...
%             B_31 B_32 B_33 B_34 B_35 B_36; B_41 B_42 B_43 B_44 B_45 B_46;...
%             B_51 B_52 B_53 B_54 B_55 B_56];
%         %C=[C_11 C_12 C_13 C_14 C_15 C_16];
%         C=[C_11 C_12 C_13 C_14 C_15];
% 		D=[D_11 D_12 D_13 D_14 D_15 D_16];

        p(1)=ssRC(1);
        p(2)=ssRC(2);
        p(3)=ssRC(3);
        p(4)=ssRC(4);
        p(5)=ssRC(5);
        p(6)=ssRC(6);
        p(7)=ssRC(7);
        p(8)=ssRC(8);
        p(9)=ssRC(9);
        p(10)=ssRC(10);
        p(11)=ssRC(11);
        p(12)=ssRC(12);
        p(13)=ssRC(13);
        p(14)=ssRC(14);
        p(15)=ssRC(15);
        p(16)=ssRC(16);
        p(17)=ssRC(17);
        p(18)=ssRC(18);
        p(19)=ssRC(19);
        p(20)=ssRC(20);
        p(21)=ssRC(21);
        p(22)=ssRC(22);        
        %R_f3=ssRC(13);
        %C_f1=ssRC(14);
        %C_f2=ssRC(15);

A = zeros(n);
B = zeros(n,m);
C = zeros(1,n);
D = zeros(1,m);


A(1,1) = -(1/(p(1)*p(12)))-(1/(p(2)*p(12)));
A(1,2) = (1/(p(2)*p(12)));
A(2,1)=1/(p(2)*p(13));
A(2,2)= -(1/(p(2)*p(13))+1/(p(3)*p(13)));
A(3,3)=-(1/(p(4)*p(14))+1/(p(5)*p(14)));
A(3,4)=1/(p(5)*p(14));
A(4,3)=1/(p(5)*p(15));
A(4,4)=-(1/(p(5)*p(15))+1/(p(6)*p(15)));
A(5,5)=-(1/(p(7)*p(16))+1/(p(8)*p(16)));
A(6,6)=-1/(p(10)*p(18));
A(6,7)=1/(p(10)*p(18));
A(7,6)=1/(p(10)*p(19));
A(7,7)=-1/(p(10)*p(19))-1/(p(11)*p(19));

%A(4,5)=1/((p(7)*p(13)));
%A(5,2)=-1/(p(3)*p(14));
%A(5,3)=1/((p(5)*p(14)));
%A(5,4)=1/((p(7)*p(14)));
%A(5,5)=-(1/((p(7)*p(14)))+1/((p(8)*p(14)))+1/((p(5)*p(14)))+1/((p(3)*p(14))));
% assign the other non-zero elements of A

B(1,1) = (1/(p(1)*p(12)));
% assign the other non-zero elements of B
B(1,3)=1/p(12);
B(2,4)=1/p(13);
B(2,11)=1/(p(3)*p(13));
B(3,1)=1/(p(4)*p(14));
B(3,5)=1/p(14);
B(4,6)=1/p(15);
B(4,11)=1/(p(6)*p(15));
B(5,2)=1/(p(7)*p(16));
B(5,7)=1/(p(16));
B(5,11)=1/(p(8)*p(16));
B(6,9)=p(21)/(2*p(18));
B(7,9)=p(21)/(2*p(19));
B(7,11)=1/(p(11)*p(19));


% B(5,1)=1/(p(8)*p(14));
% B(5,3)=1/(p(9)*p(14));
% B(5,6)=1/p(14);
% B(5,7)=1/p(14);
% assign any non-zero elements of C and D..are there any ?
C(1,2)=-1/p(3);
C(1,4)=-1/p(6);
C(1,5)=-1/p(8);
C(1,7)=-1/p(11);
D(1,1)=-1/p(9);
D(1,8)=-p(20);
D(1,10)=-p(22);
D(1,11)=1/p(3)+1/p(6)+1/p(8)+1/p(11)+1/p(9);
D(1,12)=p(17);

end